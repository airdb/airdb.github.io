(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{281:function(p,e,n){"use strict";n.r(e);var a=n(0),s=Object(a.a)({},(function(){var p=this,e=p.$createElement,n=p._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":p.$parent.slotKey}},[n("h1",{attrs:{id:"论坛部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#论坛部署"}},[p._v("#")]),p._v(" 论坛部署")]),p._v(" "),n("h2",{attrs:{id:"主机初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#主机初始化"}},[p._v("#")]),p._v(" 主机初始化")]),p._v(" "),n("p",[p._v("###1. 安装 Nginx###")]),p._v(" "),n("pre",[n("code",[p._v("`sudo yum install pcre-devel zlib-devel\n`./configure --prefix=/data/app/nginx --with-compat --add-dynamic-module=nginx-ipip-module \n`make && make install\n")])]),p._v(" "),n("p",[p._v("###日志清理###")]),p._v(" "),n("pre",[n("code",[p._v("/etc/logrotate.d/nginx\n")])]),p._v(" "),n("p",[p._v("/data/app/nginx/logs/error.log {\nsu work work\ncreate 0644 work work\ndaily\nrotate 10\nmissingok\nnotifempty\ncompress\nsharedscripts\npostrotate\n/bin/kill -USR1 "),n("code",[p._v("cat /data/app/nginx/run/nginx.pid 2>/dev/null")]),p._v(" 2>/dev/null || true\nendscript\n}")]),p._v(" "),n("p",[p._v("###3. PHP71 安装###")]),p._v(" "),n("pre",[n("code",[p._v("yum install epel-release\nrpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm\nyum install  php71w-xml php71w-process php71w-mbstring php71w-mysql php71w-gd php71w-common php71w-cli php71w-pear php71w-opcache php71w-bcmath php71w-pdo php71w-devel php71w-fpm php71w-pecl-imagick mod_php71w php71w-pecl-apcu\n\n/etc/php-fpm.d/www.conf\n")])]),p._v(" "),n("p",[p._v("###4. 设置安全组策略###")]),p._v(" "),n("pre",[n("code",[p._v("1. 默认安全组放通全部端口\n\n2. ssh http https icmp\n\n3. default\n")])]),p._v(" "),n("p",[p._v("###5. 挂载cosfs###")]),p._v(" "),n("p",[p._v("/usr/local/bin/cosfs attachment-10016990 /mnt -ourl=cos.ap-shanghai.myqcloud.com -odbglevel=info -oallow_other")]),p._v(" "),n("h2",{attrs:{id:"php-fpm-配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#php-fpm-配置"}},[p._v("#")]),p._v(" PHP-FPM 配置")]),p._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[p._v('; /etc/php-fpm.d/www.conf\ndaemonize = yes\n\n\n[www]\nuser = work\ngroup = work\n\nlisten = 0.0.0.0:9000\n; listen.allowed_clients is any.\n; listen.allowed_clients = 127.0.0.1,10.0.1.144\n\npm = dynamic\npm.max_children = 50\npm.start_servers = 5\npm.min_spare_servers = 5\npm.max_spare_servers = 35\n\nphp_value[session.save_handler] = files\nphp_value[session.save_path]    = /var/lib/php/session\nphp_value[soap.wsdl_cache_dir]  = /var/lib/php/wsdlcache\n\naccess.log = /data/logs/php-fpm/$pool.access.log\naccess.format = "%R %u %s %m %{HTTP_HOST}e%r?%q"\nslowlog = /data/logs/php-fpm/php-www-slow.log\nphp_admin_flag[log_errors] = on\nphp_admin_value[error_log] = /data/logs/php-fpm/php-www-error.log\n\nchdir = /data/app/bbs.baobeihuijia.com\n')])])])])}),[],!1,null,null,null);e.default=s.exports}}]);